<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script>
        function loadAllItems() {
            return [{
                id: 'ITEM0001',
                name: '黄焖鸡',
                price: 18.00
            }, {
                id: 'ITEM0013',
                name: '肉夹馍',
                price: 6.00
            }, {
                id: 'ITEM0022',
                name: '凉皮',
                price: 8.00
            }, {
                id: 'ITEM0030',
                name: '冰锋',
                price: 2.00
            }];
        }

        function loadPromotions() {
            return [{
                type: '满30减6元'
            }, {
                type: '指定菜品半价',
                items: ['ITEM0001', 'ITEM0022']
            }];
        }


        function bestCharge(selectedItems) {
            return /*TODO*/;
        }

        function formatTags(selectedItems) {
            return selectedItems.map(function (items){
                let info=items.split(" x ");
                return {
                    id:info[0],
                    amount:parseInt(info[1])
                }
            });
        }

        function mergeIds(ids) {
            let amount=[];
            for(let info of ids){
                let exist=amount.find(function (items) {
                    return items.id===info.id;
                });
                if(exist){
                    exist.amount+=info.amount;
                }else{
                    amount.push(Object.assign({},info,{amount:info.amount}));
                }
            }
            return amount;
        }

        function changeTypes(allPromotions) {
            let withTypeItems=[];
            for(let info of allPromotions){
                for(let i=0;i<info.length;i++){
                    if(info.type !== '满30减6元')
                        withTypeItems.push(Object.assign({},{id:info.items[i]},{type:info.type}))
                }
            }
            return withTypeItems;
        }

        function getTypeItems(withTypeItems,allItems) {

        }
    </script>>
</head>
<body>

</body>
</html>
